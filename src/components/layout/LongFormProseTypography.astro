---
export interface Props {
  class?: string;
  [key: string]: any;
}

const { class: className, ...props } = Astro.props;
---

<div class={`longform-prose cq flow ${className || ''}`} {...props}>
  <slot />
</div>

<style is:global>
  @layer longform {
    .longform-prose {
      line-height: var(--leading-loose);
      text-rendering: optimizeLegibility;
    }

    .longform-prose:last-child {
      margin-bottom: var(--space-l);
    }

    /* Headings */

    /* Article title */
    .longform-prose h1.title {
      font-size: var(--font-size-2xl);
      font-variation-settings: 'opsz' 50;
      line-height: var(--leading-snug);
      margin-bottom: var(--space-2xl);
      border-bottom: none;
    }

    /* h4-6 use bold to differentiate from h3 at same size */
    .longform-prose > :is(h4, h5, h6) {
      font-weight: var(--font-weight-bold);
    }

    /* Reduce top margin from adjacent headings */
    .longform-prose > :is(h1, h2, h3, h4, h5, h6, hr) + :is(h1, h2, h3, h4, h5, h6) {
      margin-top: var(--space-m);
    }

    .longform-prose :is(p, li, blockquote, figcaption) {
      font-variant-numeric: oldstyle-nums;
    }

    .longform-prose strong {
      font-weight: var(--font-weight-semibold);
    }

    /* ----------- Paragraphs ----------- */

    /* On small viewports: enable hyphens, disable text-wrap: pretty */
    @media (max-width: 42em) {
      .longform-prose > p {
        -webkit-hyphens: auto;
        hyphens: auto;
        text-wrap: auto;
      }
    }

    /* End Mark */
    .longform-prose > p:last-of-type:after {
      color: var(--color-accent);
      display: inline-block;
      content: ' ';
      -webkit-mask: url('/end-mark.svg');
      mask: url('/end-mark.svg');
      -webkit-mask-size: cover;
      mask-size: cover;
      background-color: currentColor;
      height: 0.65em;
      width: 1em;
      line-height: 0.5;
      margin-left: 0.1em;
    }

    /* ----------- Links ----------- */

    .longform-prose a {
      color: inherit;
      text-decoration: underline;
      text-decoration-color: var(--color-accent);
      text-decoration-thickness: var(--border-width-hairline);
      text-underline-offset: 0.3em;
      text-decoration-skip-ink: none;
      border-radius: var(--radius-xs);
      transition: color var(--duration-fast) var(--ease-in-out),
                  text-decoration-color var(--duration-fast) var(--ease-in-out);
    }

    .longform-prose a:visited {
      text-decoration-color: var(--color-visited);
    }

    .longform-prose a:is(:hover, :active) {
      text-decoration-color: var(--color-accent);
      color: var(--color-accent);
    }

    .longform-prose a:focus-visible {
      outline: var(--border-width-base) solid var(--color-accent);
      text-decoration: none;
    }

    @media (pointer: coarse) {
      .longform-prose a {
        text-decoration: none;
        color: var(--color-accent);
      }

      .longform-prose a:visited {
        color: var(--color-visited);
      }
    }

    .longform-prose h1 a {
      text-decoration: none;
      color: inherit;
    }

    /* ----------- Lists ----------- */

    .longform-prose li {
      margin-top: var(--space-2xs);
    }

    .longform-prose :is(ul, ol) {
      padding-left: 0.4em;
    }

    .longform-prose ol ::marker {
      font-size: 1.4ex;
      font-variation-settings: 'opsz' 10;
      font-weight: var(--font-weight-medium);
    }

    /* ----------- Task Lists ------------ */

    .longform-prose .contains-task-list {
      list-style-type: none;
      padding-left: 0;
    }

    .longform-prose .task-list-item {
      padding-left: 0;
    }

    .longform-prose .task-list-item input {
      position: relative;
      height: 0.7em;
      width: 0.7em;
      margin-bottom: 0;
      appearance: none;
      outline: none;
      border-radius: var(--radius-xs);
      border: var(--border-width-hairline) solid var(--color-border);
    }

    .longform-prose .task-list-item input:checked {
      color: var(--color-accent);
      background: transparent;
      border-color: var(--color-accent);
    }

    .longform-prose .task-list-item input:checked:before {
      content: '\2713';
      position: absolute;
      top: -0.1em;
      left: 0.05em;
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      color: var(--color-accent);
    }

    .longform-prose .task-list-item input[disabled] {
      opacity: 1;
    }

    /* ----------- HR ----------- */
    .longform-prose hr {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 0;
      overflow: visible;
      margin: var(--space-xl) 0;

      border: var(--border-width-hairline) solid var(--color-border);
    }

    .longform-prose hr:before {
      content: 'ยง';
      transform: translateY(-0.15em);
      background: var(--color-background);
      padding: 0 var(--space-2xs);
    }

    /* ----------- Footnotes ----------- */

    .longform-prose [data-footnote-ref] {
      display: inline-block;
      padding-inline: 0.5ch;
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      font-variant: small-caps;
      letter-spacing: var(--tracking-wide);
      text-decoration: none;
      color: var(--color-accent);
    }

    .longform-prose .footnotes {
      border-top: var(--border-width-hairline) solid var(--color-accent);
      margin-top: var(--space-m);
      padding-top: var(--space-s);
      font-size: var(--font-size-sm);

      [data-footnote-backref] {
        text-decoration: none;
        color: var(--color-accent);
      }
    }
  }
</style>
