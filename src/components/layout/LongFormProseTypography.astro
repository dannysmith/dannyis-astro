---
export interface Props {
  class?: string;
  [key: string]: any;
}

const { class: className, ...props } = Astro.props;
---

<div class={`longform-prose cq flow ${className || ''}`} {...props}>
  <slot />
</div>

<style is:global>
  @layer longform {
    .longform-prose {
      line-height: var(--leading-loose);
      text-rendering: optimizeLegibility;
    }

    .longform-prose:last-child {
      margin-bottom: var(--space-l);
    }

    /* Headings */

    /* Article title */
    .longform-prose h1.title {
      font-size: var(--font-size-2xl);
      font-variation-settings: 'opsz' 50;
      line-height: var(--leading-snug);
      margin-bottom: var(--space-2xl);
      border-bottom: none;
    }

    /* h4-6 use bold to differentiate from h3 at same size */
    .longform-prose > :is(h4, h5, h6) {
      font-weight: var(--font-weight-bold);
    }

    /* Reduce top margin from adjacent headings */
    .longform-prose > :is(h1, h2, h3, h4, h5, h6, hr) + :is(h1, h2, h3, h4, h5, h6) {
      margin-top: var(--space-m);
    }

    .longform-prose :is(p, li, blockquote, figcaption) {
      font-variant-numeric: oldstyle-nums;
    }

    .longform-prose strong {
      font-weight: var(--font-weight-semibold);
    }

    /* ----------- Paragraphs ----------- */

    /* On small viewports: enable hyphens, disable text-wrap: pretty */
    @media (max-width: 42em) {
      .longform-prose > p {
        -webkit-hyphens: auto;
        hyphens: auto;
        text-wrap: auto;
      }
    }

    /* End Mark */
    .longform-prose > p:last-of-type:after {
      color: var(--color-accent);
      display: inline-block;
      content: ' ';
      -webkit-mask: url('/end-mark.svg');
      mask: url('/end-mark.svg');
      -webkit-mask-size: cover;
      mask-size: cover;
      background-color: currentColor;
      height: 0.65em;
      width: 1em;
      line-height: 0.5;
      margin-left: 0.1em;
    }

    /* ----------- Links ----------- */
    /* Exclude footnote links - they have their own styling in global.css */

    .longform-prose a:not([data-footnote-ref], [data-footnote-backref]) {
      color: inherit;
      text-decoration: underline;
      text-decoration-color: var(--color-accent);
      text-decoration-thickness: var(--border-width-hairline);
      text-underline-offset: 0.15em;
      text-decoration-skip-ink: none;
      border-radius: var(--radius-xs);
      transition: color var(--duration-fast) var(--ease-in-out),
                  text-decoration-color var(--duration-fast) var(--ease-in-out);
    }

    .longform-prose a:not([data-footnote-ref], [data-footnote-backref]):visited {
      text-decoration-color: var(--color-visited);
    }

    .longform-prose a:not([data-footnote-ref], [data-footnote-backref]):is(:hover, :active) {
      text-decoration-color: var(--color-accent);
      color: var(--color-accent);
    }

    .longform-prose a:not([data-footnote-ref], [data-footnote-backref]):focus-visible {
      outline: var(--border-width-base) solid var(--color-accent);
      text-decoration: none;
    }

    @media (pointer: coarse) {
      .longform-prose a:not([data-footnote-ref], [data-footnote-backref]) {
        text-decoration: none;
        color: var(--color-accent);
      }

      .longform-prose a:not([data-footnote-ref], [data-footnote-backref]):visited {
        color: var(--color-visited);
      }
    }

    .longform-prose h1 a {
      text-decoration: none;
      color: inherit;
    }

    /* ----------- HR ----------- */
    .longform-prose hr {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 0;
      overflow: visible;
      margin: var(--space-xl) 0;
      border: var(--border-width-hairline) solid var(--color-border);
    }

    .longform-prose hr:before {
      content: 'ยง';
      transform: translateY(-0.15em);
      background: var(--color-background);
      padding: 0 var(--space-2xs);
    }
  }
</style>
