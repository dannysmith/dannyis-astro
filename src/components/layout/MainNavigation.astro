---
import NavLink from '@components/navigation/NavLink.astro';
import ThemeToggle from '@components/navigation/ThemeToggle.astro';
import PersonalLogo from '@components/ui/PersonalLogo.astro';
import { Icon } from 'astro-icon/components';
const isDev = import.meta.env.MODE === 'development';
---

<a class="open-nav-link" href="#">
  <Icon name="heroicons:bars-3" />
</a>
<nav class="main-navigation ui-style dark-surface">
  <span class="close">&times;</span>
  <PersonalLogo />
  <section class="nav-nav-links all-caps">
    <ul class="list-reset">
      <li><NavLink href="/">Home</NavLink></li>
      <li><NavLink href="/writing">Writing</NavLink></li>
      <li><NavLink href="/notes">Notes</NavLink></li>
      {
        isDev && (
          <li>
            <NavLink href="/styleguide">Styleguide</NavLink>
          </li>
        )
      }
    </ul>
  </section>
  <theme-toggle>
    <ThemeToggle />
  </theme-toggle>
</nav>

<style>
  .open-nav-link {
    display: block;
    position: absolute;
    top: var(--space-s);
    left: var(--space-s);
    width: 2em;
    height: 2em;
    padding: var(--space-2xs);
    border-radius: var(--radius-xs);
    z-index: 1000;
    color: var(--color-beige);
    cursor: pointer;
    background: var(--color-charcoal);
  }

  .main-navigation {
    position: fixed;
    left: -100%;
    min-height: 100vh;
    z-index: 1000;
    border-right: var(--border-width-accent) solid var(--color-accent);
    padding: var(--space-s) var(--space-l) var(--space-s) var(--space-s);
    font-size: clamp(0.8rem, calc(0.6rem + 1vw), 1.2rem);
    transition: left var(--duration-normal) var(--ease-in-out);
  }

  .main-navigation.open {
    left: 0;
  }

  .nav-nav-links {
    margin-top: var(--space-s);
    padding-left: var(--space-l);

    li {
      padding: 0;
      line-height: var(--leading-loose);
    }

    a {
      padding: var(--space-2xs);
    }

    a.active {
      color: var(--color-accent);
    }
  }

  .close {
    position: absolute;
    top: var(--space-xs);
    right: var(--space-xs);
    font-size: 1em;
    cursor: pointer;
  }

  @media (max-width: 600px) {
    .nav-nav-links a {
      display: flex;
      align-items: center;
      min-height: 44px; /* Touch target */
      padding-block: var(--space-xs);
    }
  }
</style>

<script>
  const closeNav = () => {
    document.querySelector('.main-navigation')?.classList.remove('open');
  };

  const openNav = () => {
    document.querySelector('.main-navigation')?.classList.add('open');
  };

  document.querySelector('.close')?.addEventListener('click', closeNav);
  document.querySelector('main')?.addEventListener('click', closeNav);
  document.querySelector('footer')?.addEventListener('click', closeNav);
  document.querySelector('.open-nav-link')?.addEventListener('click', openNav);
</script>
