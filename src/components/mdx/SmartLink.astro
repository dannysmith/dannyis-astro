---
export interface Props {
  href: string;
  [key: string]: any;
}

const { href, ...props } = Astro.props;

// Determine link type
const isExternal = href?.startsWith('http') && !href.includes('danny.is');
const isInternal = href?.startsWith('/') || href?.startsWith('#');
const isEmail = href?.startsWith('mailto:');
const isTel = href?.startsWith('tel:');
---

<a
  href={href}
  target={isExternal ? '_blank' : undefined}
  rel={isExternal ? 'noopener noreferrer' : undefined}
  class:list={[
    'smart-link',
    {
      external: isExternal,
      internal: isInternal,
      email: isEmail,
      tel: isTel,
    },
  ]}
  {...props}
>
  <slot />
</a>

<style>
  .smart-link.external::after {
    content: '↗';
    font-size: 0.8em;
    margin-left: 0.2em;
    opacity: 0.7;
  }

  .smart-link.email::before {
    content: '✉ ';
    font-size: 0.8em;
    opacity: 0.7;
  }

  .smart-link.tel::before {
    content: '☎ ';
    font-size: 0.8em;
    opacity: 0.7;
  }
</disabled-style>
