/* ============================================
   VERTICAL FLOW
   ============================================

   Vertical rhythm for prose content. Most spacing is applied globally
   to block elements, so content looks good anywhere. The .flow utility
   class adds enhanced heading spacing for long-form prose containers.

   Uses em units so spacing scales with the element's font-size.
   Uses :where() for zero specificity.

   ============================================ */

@layer typography {

  /* -------------------------------------------
     GLOBAL BLOCK SPACING
     Applied everywhere, not just in .flow containers.
     ------------------------------------------- */

  /* Headings get more breathing room above them */
  :where(:is(h1, h2, h3, h4, h5, h6)) {
    margin-top: 1.5em;

    &:first-child {
      margin-top: 0;
    }
  }

  /* Standard prose elements - paragraphs, lists, etc. */
  :where(p, ul, ol, blockquote, pre, figure, table) {
    margin-top: 1.25em;

    &:first-child {
      margin-top: 0;
    }
  }

  /* Horizontal rules create larger visual breaks */
  :where(hr) {
    margin-block: var(--space-l);
  }

  /* Footnotes section sits well below the main content */
  :where(.footnotes) {
    margin-top: var(--space-2xl);
  }

  /* -------------------------------------------
     .flow UTILITY
     Apply to prose containers for consistent spacing on
     elements not covered by the global rules above.
     ------------------------------------------- */

  .flow {
    /*
     * Catch-all for elements not handled globally above
     * `* + X` = X that follows a sibling (not first-child).
     * Catches <details>, <aside>, <div>, custom elements, etc.
     */
    & > * + *:not(h1, h2, h3, h4, h5, h6, p, ul, ol, blockquote, pre, figure, table, hr) {
      margin-top: 1.25em;
    }

    /*
     * Reduce space between adjacent headings (e.g., h2 followed by h3).
     * They form a logical unit so don't need the full heading margin.
     */
    & > :is(h1, h2, h3, h4, h5, h6, hr) + :is(h1, h2, h3, h4, h5, h6) {
      margin-top: 0.5em;
    }
  }
}
