/* Define our layers */
@layer reset, base, simple-prose, longform-prose, theme;

/* Import Mermaid styles */
@import './mermaid.css';

/* Font faces - these need to be outside layers as they're declarations */
@font-face {
  font-family: 'Literata';
  src: url('/fonts/Literata-self-compiled-Mar2019.woff2') format('woff2');
  font-style: normal;
  font-display: swap;
}
@font-face {
  font-family: 'Literata';
  src: url('/fonts/Literata-Italic-self-compiled-Mar2019.woff2') format('woff2');
  font-style: italic;
  font-display: swap;
}

/* ============================================
   TYPE-SAFE CUSTOM PROPERTIES (@property)
   Enables animation and provides type checking
   ============================================ */

@property --color-accent {
  syntax: '<color>';
  inherits: true;
  initial-value: oklch(70% 0.18 25);
}

@property --surface-raised {
  syntax: '<color>';
  inherits: true;
  initial-value: #ffffff;
}

/* CSS Custom Properties - these need to be outside layers as they're declarations */
:root {
  /* ============================================
     PRIMITIVE COLOR PALETTE - OKLCH
     Perceptually uniform, wide gamut colors
     ============================================ */

  /* Neutrals */
  --color-black: oklch(15% 0 0);          /* #191919 */
  --color-true-black: oklch(0% 0 0);      /* #000000 */

  /* Pink (hue: 350) */
  --color-pink-300: oklch(92% 0.04 350);
  --color-pink-400: oklch(86% 0.08 350);
  --color-pink-500: oklch(62% 0.18 350);
  --color-pink-600: oklch(48% 0.16 350);
  --color-pink-700: oklch(38% 0.08 350);
  --color-pink-800: oklch(32% 0.04 350);

  /* Red/Coral - Brand accent (hue: 25) */
  --color-red-300: oklch(92% 0.04 25);
  --color-red-400: oklch(86% 0.08 25);
  --color-red-500: oklch(70% 0.18 25);    /* Primary brand coral */
  --color-red-600: oklch(58% 0.18 25);
  --color-red-700: oklch(48% 0.12 25);
  --color-red-800: oklch(35% 0.06 25);

  /* Orange (hue: 55) */
  --color-orange-300: oklch(94% 0.04 55);
  --color-orange-400: oklch(88% 0.10 55);
  --color-orange-500: oklch(78% 0.16 55);
  --color-orange-600: oklch(68% 0.16 55);
  --color-orange-700: oklch(48% 0.08 55);
  --color-orange-800: oklch(38% 0.04 55);

  /* Purple (hue: 300) */
  --color-purple-300: oklch(92% 0.04 300);
  --color-purple-400: oklch(86% 0.08 300);
  --color-purple-500: oklch(60% 0.14 300);
  --color-purple-600: oklch(48% 0.16 300);
  --color-purple-700: oklch(48% 0.08 300);
  --color-purple-800: oklch(32% 0.04 300);

  /* Yellow (hue: 95) */
  --color-yellow-300: oklch(96% 0.04 95);
  --color-yellow-400: oklch(94% 0.10 95);
  --color-yellow-500: oklch(90% 0.16 95);
  --color-yellow-600: oklch(80% 0.14 95);
  --color-yellow-700: oklch(48% 0.06 95);
  --color-yellow-800: oklch(40% 0.03 95);

  /* Green (hue: 165) */
  --color-green-300: oklch(92% 0.04 165);
  --color-green-400: oklch(88% 0.08 165);
  --color-green-500: oklch(65% 0.12 165);
  --color-green-600: oklch(52% 0.12 165);
  --color-green-700: oklch(42% 0.06 165);
  --color-green-800: oklch(35% 0.04 165);

  /* Blue (hue: 230) */
  --color-blue-300: oklch(92% 0.03 230);
  --color-blue-400: oklch(88% 0.06 230);
  --color-blue-500: oklch(62% 0.12 230);
  --color-blue-600: oklch(50% 0.14 230);
  --color-blue-700: oklch(40% 0.08 230);
  --color-blue-800: oklch(32% 0.04 230);

  /* Brown (hue: 40) */
  --color-brown-300: oklch(92% 0.02 40);
  --color-brown-400: oklch(88% 0.04 40);
  --color-brown-500: oklch(55% 0.06 40);
  --color-brown-600: oklch(40% 0.06 40);
  --color-brown-700: oklch(35% 0.03 40);
  --color-brown-800: oklch(30% 0.02 40);

  /* Grey (neutral) */
  --color-grey-300: oklch(93% 0 0);
  --color-grey-400: oklch(93% 0 0);
  --color-grey-500: oklch(65% 0 0);
  --color-grey-600: oklch(65% 0 0);
  --color-grey-700: oklch(42% 0 0);
  --color-grey-800: oklch(32% 0 0);

  /* Background scales */
  --color-bg-light-100: oklch(100% 0 0);
  --color-bg-light-200: oklch(97% 0.005 210);
  --color-bg-light-300: oklch(92% 0.005 210);
  --color-bg-light-400: oklch(68% 0.005 210);
  --color-bg-light-500: oklch(50% 0.005 210);
  --color-bg-light-600: oklch(38% 0.005 210);
  --color-bg-light-700: oklch(28% 0.01 210);
  --color-bg-light-800: oklch(15% 0 0);

  --color-bg-dark-100: oklch(15% 0 0);
  --color-bg-dark-200: oklch(18% 0 0);
  --color-bg-dark-300: oklch(22% 0 0);
  --color-bg-dark-400: oklch(26% 0 0);
  --color-bg-dark-500: oklch(58% 0 0);
  --color-bg-dark-600: oklch(65% 0 0);
  --color-bg-dark-700: oklch(86% 0 0);
  --color-bg-dark-800: oklch(100% 0 0);

  /* Named Brand colours - OKLCH */
  --color-brand-primary: var(--color-red-500);
  --color-brand-grey: var(--color-bg-light-700);
  --color-brand-dark-grey: var(--color-bg-light-800);
  --color-brand-white: oklch(100% 0 0);
  --color-brand-black: var(--color-black);
  --color-brand-beige: oklch(96% 0.02 85);

  /* Shadows - should be used like filter:var(--shadow-xsmall)*/

  --shadow-xsmall: drop-shadow(0px 1px 2px rgba(16, 24, 40, 0.05));
  --shadow-small: drop-shadow(0px 1px 3px rgba(16, 24, 40, 0.1))
    drop-shadow(0px 1px 2px rgba(16, 24, 40, 0.1));
  --shadow-medium: drop-shadow(0px 1px 3px rgba(16, 24, 40, 0.1))
    drop-shadow(0px 4px 6px rgba(16, 24, 40, 0.1));
  --shadow-large: drop-shadow(0px 10px 15px rgba(16, 24, 40, 0.1))
    drop-shadow(0px 4px 6px rgba(16, 24, 40, 0.1));
  --shadow-xlarge: drop-shadow(0px 20px 25px rgba(16, 24, 40, 0.1))
    drop-shadow(0px 8px 10px rgba(16, 24, 40, 0.1));
  --shadow-xxlarge: drop-shadow(0px 25px 50px rgba(16, 24, 40, 0.25));

  /*  Fonts */
  --font-ui: 'League Spartan Variable', 'Inter', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  --font-prose: 'Literata', Georgia, 'Times New Roman', serif;
  --font-code: 'Fira Code Variable', 'Fira Code', 'Inconsolata', monospace;

  /* Spacer sizes - DEPRECATED: use --space-* tokens instead */
  --spacer-xs: var(--space-2);   /* 0.5rem - alias to new system */
  --spacer-sm: var(--space-4);   /* 1rem */
  --spacer-md: var(--space-6);   /* 2rem */
  --spacer-lg: var(--space-10);  /* 3rem */
  --spacer-xl: var(--space-12);  /* 4rem */
  --spacer-xxl: var(--space-20); /* 6rem */

  /* ============================================
     MODERN DESIGN TOKEN SYSTEM
     See docs/developer/design-tokens.md for full documentation
     ============================================ */

  /* ============================================
     SPACING - Static 8px Grid
     ============================================ */
  --space-0: 0;
  --space-1: 0.25rem;   /*  4px - micro adjustments */
  --space-2: 0.5rem;    /*  8px - tight spacing */
  --space-3: 0.75rem;   /* 12px - small gaps */
  --space-4: 1rem;      /* 16px - base unit */
  --space-5: 1.5rem;    /* 24px - comfortable */
  --space-6: 2rem;      /* 32px - breathing room */
  --space-8: 2.5rem;    /* 40px - section spacing */
  --space-10: 3rem;     /* 48px - major sections */
  --space-12: 4rem;     /* 64px - hero spacing */
  --space-16: 5rem;     /* 80px - dramatic spacing */
  --space-20: 6rem;     /* 96px - monumental */

  /* Fluid Spacing - Utopia generated (375px → 1280px) */
  --space-fluid-s-l: clamp(1.125rem, 0.5rem + 2.5vw, 2.5rem);   /* 18px → 40px */
  --space-fluid-m-xl: clamp(1.5rem, 0.75rem + 3vw, 3.75rem);    /* 24px → 60px */

  /* ============================================
     TYPOGRAPHY - Utopia Fluid Type Scale
     https://utopia.fyi/type/calculator?c=375,18,1.2,1280,20,1.333,5,2
     ============================================ */

  /* Raw Utopia steps */
  --step--2: clamp(0.78rem, 0.77rem + 0.03vw, 0.80rem);   /* ~12.5px → 12.8px */
  --step--1: clamp(0.94rem, 0.91rem + 0.11vw, 1.00rem);   /* ~15px → 16px */
  --step-0:  clamp(1.13rem, 1.07rem + 0.23vw, 1.25rem);   /* ~18px → 20px (base) */
  --step-1:  clamp(1.35rem, 1.26rem + 0.39vw, 1.67rem);   /* ~21.6px → 26.7px */
  --step-2:  clamp(1.62rem, 1.48rem + 0.61vw, 2.22rem);   /* ~25.9px → 35.5px */
  --step-3:  clamp(1.94rem, 1.74rem + 0.90vw, 2.96rem);   /* ~31.1px → 47.4px */
  --step-4:  clamp(2.33rem, 2.04rem + 1.31vw, 3.95rem);   /* ~37.3px → 63.2px */
  --step-5:  clamp(2.80rem, 2.38rem + 1.85vw, 5.26rem);   /* ~44.8px → 84.2px */

  /* Semantic font-size aliases */
  --font-size-xs: var(--step--2);    /* Small labels, captions */
  --font-size-sm: var(--step--1);    /* Secondary text, metadata */
  --font-size-base: var(--step-0);   /* Body text */
  --font-size-md: var(--step-1);     /* Large body, small headings */
  --font-size-lg: var(--step-2);     /* H3, card titles */
  --font-size-xl: var(--step-3);     /* H2, section titles */
  --font-size-2xl: var(--step-4);    /* H1, page titles */
  --font-size-3xl: var(--step-5);    /* Hero masthead */

  /* Line Heights */
  --leading-none: 0.9;     /* Hero text, large display */
  --leading-tight: 1.1;    /* Headings */
  --leading-snug: 1.2;     /* Subheadings */
  --leading-normal: 1.5;   /* Body text */
  --leading-relaxed: 1.7;  /* Long-form prose */
  --leading-loose: 1.8;    /* Extra breathing room */

  /* Letter Spacing */
  --tracking-tighter: -0.02em;  /* Large display text */
  --tracking-tight: -0.01em;    /* Headings */
  --tracking-normal: 0;         /* Body text */
  --tracking-wide: 0.08em;      /* All-caps labels */
  --tracking-wider: 0.1ch;      /* Small all-caps */

  /* Font Weights - matched to Literata/League Spartan */
  --font-weight-light: 300;
  --font-weight-normal: 350;
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --font-weight-black: 900;

  /* ============================================
     BORDERS - The Coral Rule System
     ============================================ */

  /* Border widths */
  --border-width-hairline: 1px;    /* Subtle dividers */
  --border-width-thin: 1.5px;      /* Default borders */
  --border-width-base: 2px;        /* THE CORAL RULE */
  --border-width-thick: 4px;       /* Heavy dividers */
  --border-width-heavy: 6px;       /* Blockquotes */
  --border-width-accent: 1rem;     /* Bold accent strips (NoteCard, Footer, Nav panel) */

  /* Border radius */
  --radius-xs: 0.125rem;   /* 2px */
  --radius-sm: 0.25rem;    /* 4px */
  --radius-md: 0.5rem;     /* 8px */
  --radius-lg: 0.75rem;    /* 12px */
  --radius-xl: 1rem;       /* 16px */
  --radius-full: 9999px;   /* Pills */

  /* ============================================
     MOTION - Durations & Easing
     ============================================ */

  /* Durations */
  --duration-instant: 0ms;
  --duration-fast: 150ms;      /* Micro-interactions */
  --duration-normal: 200ms;    /* Standard transitions */
  --duration-slow: 300ms;      /* Emphasis */
  --duration-slower: 500ms;    /* Accordions, reveals */

  /* Easing functions */
  --ease-default: ease;
  --ease-in: cubic-bezier(0.4, 0, 1, 1);
  --ease-out: cubic-bezier(0, 0, 0.2, 1);
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);

  /* ============================================
     ELEVATION - Surface + Shadow combinations
     ============================================ */
  --elevation-flat: none;
  --elevation-low: var(--shadow-small);
  --elevation-medium: var(--shadow-medium);
  --elevation-high: var(--shadow-large);
  --elevation-highest: var(--shadow-xlarge);
}

/* Reset Layer */
@layer reset {
  /* Use a more-intuitive box-sizing model with :where() for zero specificity */
  :where(*, *::before, *::after) {
    box-sizing: border-box;
  }

  /* Remove default margin */
  :where(*) {
    margin: 0;
  }

  /* Better focus outline spacing */
  :where(:focus-visible) {
    outline-offset: 3px;
  }

  /* Enable keyword animations (animate to/from 'auto') */
  @media (prefers-reduced-motion: no-preference) {
    :where(html) {
      interpolate-size: allow-keywords;
    }
  }

  /* Prevent font size inflation on mobile */
  :where(html) {
    -moz-text-size-adjust: none;
    -webkit-text-size-adjust: none;
    text-size-adjust: none;

    /* Prevent layout shift when scrollbars appear */
    scrollbar-gutter: stable;
  }

  :where(body) {
    /* Add accessible line-height */
    line-height: 1.5;

    /* Improve text rendering */
    -webkit-font-smoothing: antialiased;

    /* Sensible min-height */
    min-height: 100vh;

    /* Position relative for absolutely positioned children */
    position: relative;

    /* Remove default padding */
    padding: 0;
  }

  /* Improve media defaults */
  :where(img, picture, video, canvas, svg) {
    display: block;
    max-width: 100%;
  }

  :where(img, picture) {
    height: auto;
  }

  /* Remove default img border */
  :where(img) {
    border: 0;
  }

  /* Inherit fonts for form controls */
  :where(input, button, textarea, select) {
    font: inherit;
  }

  /* Auto-growing textarea */
  :where(textarea) {
    field-sizing: content;
  }

  /* Fix fieldset sizing in flexbox/grid */
  :where(fieldset) {
    min-inline-size: 0;
  }

  /* Normalize search input appearance */
  :where([type='search']) {
    -webkit-appearance: textfield;
    appearance: textfield;
  }

  /* Keep specific input types LTR in RTL layouts */
  :where(
    input:is([type='tel'], [type='url'], [type='email'], [type='number']):not(:placeholder-shown)
  ) {
    direction: ltr;
  }

  /* Sensible defaults for iframes */
  :where(iframe) {
    border: 0;
    overflow: hidden;
  }

  /* Avoid text overflows */
  :where(p, h1, h2, h3, h4, h5, h6) {
    overflow-wrap: break-word;
  }

  /* Improve line wrapping */
  :where(h1, h2, h3, h4, h5, h6) {
    text-wrap: balance;
  }

  /* Prevent widows and orphans in body text */
  :where(p, blockquote) {
    text-wrap: pretty;
  }

  /* Anything that has been anchored to should have extra scroll margin */
  :where(:target) {
    scroll-margin-block: 5ex;
  }

  /* Sensible wrapping for code blocks */
  :where(pre) {
    white-space: pre-wrap;
  }

  /* Strengthen hidden attribute */
  :where([hidden]:not([hidden='until-found'])) {
    display: none !important;
  }

  /* Remove list styles on ul, ol elements with a list role */
  :where(ul[role='list'], ol[role='list']) {
    list-style: none;
  }
}

/* Base Layer */
@layer base {
  html {
    /* Typography - moved from body */
    font-variant-ligatures: common-ligatures;
    hanging-punctuation: first allow-end last;

    /* Set the typeface */
    font-family: var(--font-ui);
    font-weight: 300;

    /* Colors - support both light/dark */
    color-scheme: light dark;
    accent-color: var(--color-accent);
    color: var(--color-text-primary);

    /* Smooth Scrolling */
    scroll-behavior: smooth;
  }

  body {
    /* Background color */
    background-color: var(--color-bg-primary);
  }

  /* Set shorter line heights on headings and interactive elements */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  button,
  input,
  label {
    line-height: 1.1;
  }

  /* Default Links */
  a {
    transition: all 0.15s;

    &,
    &:visited {
      text-decoration: none;
      color: var(--color-text-primary);
    }

    &:hover,
    &:focus,
    &:active {
      color: var(--color-accent);
    }
  }

  /* Better link underlines for links without classes */
  a:not([class]) {
    text-decoration: underline;
    text-decoration-thickness: max(0.08em, 1px);
    text-underline-offset: 0.2em;
    text-decoration-skip-ink: auto;
    color: currentColor;
  }

  /* Subtle underlines when not interacting */
  a:not([class]):not(:is(:hover, :focus)) {
    text-decoration-color: color-mix(in srgb, currentColor, transparent 75%);
  }

  /* Abbreviations */
  abbr {
    font-variant: all-small-caps;
    text-decoration: underline;
    text-decoration-style: dashed;
    text-decoration-color: color-mix(in srgb, currentColor, transparent 50%);
    text-decoration-thickness: max(0.08em, 1px);
    text-underline-offset: 0.2em;
    text-decoration-skip-ink: none;
  }

  abbr[title] {
    cursor: help;
  }

  /* Superscript and subscript */
  sup,
  sub {
    font-size: 0.7em;
    line-height: 1;
  }

  /* Strikethrough */
  del {
    text-decoration: line-through;
    text-decoration-color: color-mix(in srgb, currentColor, transparent 50%);
    text-decoration-thickness: 1px;
    text-underline-offset: 0.2em;
  }

  /* Highlight */
  mark {
    background-color: var(--color-mark-bg);
    border-radius: 0.05em;
  }

  /* High contrast mode support for mark */
  @media (forced-colors: active) {
    mark {
      color: HighlightText;
      background-color: Highlight;
    }
  }

  /* Simple, attractive global table styles */
  table {
    border-collapse: collapse;
    width: 100%;
    margin: 2em 0;
    font-size: 1em;
    background-color: var(--color-table-bg);
    caption-side: bottom;
  }

  th,
  td {
    border: 1px solid var(--color-table-border);
    padding: 0.2em 0.5em;
    text-align: left;
    vertical-align: baseline;
  }

  th {
    font-weight: 600;
    text-transform: uppercase;
    background: var(--color-table-header-bg);
    border-bottom-width: 2px;
  }

  /* Better cursor for summary */
  summary {
    cursor: default;
  }

  /* Smooth scrolling for user-initiated navigation */
  @media (prefers-reduced-motion: no-preference) {
    html:focus-within {
      scroll-behavior: smooth;
    }
  }
}

/* Theme Layer - Using light-dark() for automatic theming */
@layer theme {
  @media (prefers-reduced-motion: reduce) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }

  /* ============================================
     SEMANTIC COLORS - Using light-dark()
     Automatically adapts to color-scheme preference
     ============================================ */
  :root {
    /* Enable automatic theme switching */
    color-scheme: light dark;

    /* -------------------- TYPOGRAPHY VARIABLES -------------------- */
    /* Note: light-dark() only works for colors, so we use defaults + dark override */
    --font-weight-prose: 400;
    --line-height-prose: 1.7;
    --font-weight-article: 350;
    --line-height-article: 1.7;

    /* -------------------- PRIMARY GLOBAL COLOURS -------------------- */
    /* Background colors */
    --color-bg-primary: light-dark(var(--color-brand-beige), var(--color-bg-dark-200));
    --color-bg-secondary: light-dark(
      oklch(98% 0.01 85),
      oklch(14% 0 0)
    );

    /* Text colors */
    --color-text-primary: light-dark(var(--color-brand-grey), var(--color-brand-beige));
    --color-text-secondary: light-dark(var(--color-grey-800), var(--color-grey-500));
    --color-accent: var(--color-brand-primary);

    /* Border and divider colors */
    --color-border: light-dark(oklch(0% 0 0 / 0.1), oklch(100% 0 0 / 0.1));

    /* Interactive colors */
    --color-link: light-dark(var(--color-red-500), var(--color-red-400));
    --color-link-visited: light-dark(var(--color-purple-600), var(--color-purple-500));
    --color-link-hover: light-dark(var(--color-red-600), var(--color-red-500));

    /* Inline elements */
    --color-mark-bg: light-dark(var(--color-yellow-500), var(--color-yellow-600));
    --color-strikethrough: light-dark(oklch(0% 0 0 / 0.5), oklch(100% 0 0 / 1));
    --color-abbr-underline: light-dark(oklch(0% 0 0 / 0.15), oklch(100% 0 0 / 0.1));

    /* Table colors */
    --color-table-border: light-dark(oklch(0% 0 0 / 0.1), oklch(100% 0 0 / 0.1));
    --color-table-bg: var(--color-bg-secondary);
    --color-table-header-bg: var(--color-bg-secondary);

    /* Code colors */
    --color-code-background: var(--color-bg-secondary);

    /* -------------------- SURFACE ELEVATION SYSTEM -------------------- */
    --surface-base: var(--color-bg-primary);
    --surface-raised: light-dark(
      oklch(100% 0 0),         /* Light: white */
      oklch(22% 0 0)           /* Dark: elevated charcoal */
    );
    --surface-inset: light-dark(
      oklch(92% 0.02 85),      /* Light: darker beige */
      oklch(14% 0 0)           /* Dark: deeper charcoal */
    );
    --surface-overlay: light-dark(
      oklch(98% 0.01 85),
      oklch(26% 0 0)
    );

    /* -------------------- PROSE TYPOGRAPHY COLOURS -------------------- */
    --prose-heading-border-color: var(--color-border);
    --prose-link-color: var(--color-link);
    --prose-link-visited-color: var(--color-link-visited);
    --prose-link-hover-color: var(--color-link-hover);
    --prose-blockquote-border-color: var(--color-accent);
    --prose-list-marker-color: var(--color-accent);

    /* -------------------- COMPONENT COLOURS -------------------- */
    /* Navigation colors - nav/footer stay dark in both themes */
    --color-nav-bg: var(--color-bg-dark-200);
    --color-nav-text: var(--color-brand-white);
    --color-nav-link-hover: var(--color-brand-primary);
    --color-nav-border: var(--color-brand-primary);
    --color-hamburger-bg: light-dark(oklch(100% 0 0 / 0.6), oklch(0% 0 0 / 0.8));
    --color-hamburger-text: var(--color-brand-primary);

    /* Footer colors */
    --color-footer-bg: var(--color-bg-dark-200);
    --color-footer-text: var(--color-brand-white);
    --color-footer-link-hover: var(--color-brand-primary);
    --color-footer-border: var(--color-brand-primary);
    --color-footer-social-hover: oklch(0% 0 0 / 0.25);

    /* NoteCard colors */
    --color-notecard-bg: light-dark(var(--color-brand-white), var(--surface-raised));
    --color-notecard-border: light-dark(var(--color-bg-dark-200), var(--color-accent));
    --color-notecard-dot-grid: light-dark(var(--color-red-400), transparent);
    --color-notecard-date: var(--color-text-secondary);
    --color-notecard-title-underline: var(--color-accent);

    /* ContentCard colors */
    --color-contentcard-bg: light-dark(var(--color-brand-white), var(--surface-raised));
    --color-contentcard-border: var(--color-border);
    --color-contentcard-article-accent: var(--color-red-500);
    --color-contentcard-note-accent: light-dark(var(--color-blue-500), var(--color-blue-400));
    --color-contentcard-toolbox-accent: light-dark(var(--color-green-500), var(--color-green-400));
    --color-contentcard-meta: var(--color-text-secondary);
    --color-contentcard-summary: var(--color-text-primary);

    /* Pill colors */
    --color-pill-bg: light-dark(var(--color-grey-400), var(--color-grey-800));
    --color-pill-fg: light-dark(var(--color-grey-500), var(--color-grey-400));

    /* Lightbox colors */
    --color-lightbox-bg: oklch(0% 0 0 / 0.9);
    --color-lightbox-close: var(--color-brand-white);

    /* Callout colors */
    --color-callout-default-bg: light-dark(var(--color-grey-300), var(--color-grey-800));
    --color-callout-red-bg: light-dark(var(--color-red-300), var(--color-red-800));
    --color-callout-blue-bg: light-dark(var(--color-blue-300), var(--color-blue-800));
    --color-callout-green-bg: light-dark(var(--color-green-300), var(--color-green-800));
    --color-callout-orange-bg: light-dark(var(--color-orange-300), var(--color-orange-800));
    --color-callout-yellow-bg: light-dark(var(--color-yellow-300), var(--color-yellow-800));
    --color-callout-purple-bg: light-dark(var(--color-purple-300), var(--color-purple-800));

    /* Article specific colors */
    --color-article-bg: var(--color-bg-primary);
    --color-article-accent: light-dark(oklch(52% 0.14 25), var(--color-accent));
    --color-article-horizontal-rule: var(--color-border);
    --color-article-inline-footnote-bg: var(--color-bg-secondary);
    --color-article-tasklist-border: var(--color-border);

    /* Notion colors */
    --notion-arrow-color: oklch(100% 0 0 / 0.6);
    --notion-underline-color: light-dark(oklch(0% 0 0 / 0.15), oklch(100% 0 0 / 0.25));
    --notion-arrow-stroke-color: var(--color-bg-primary);
    --notion-hover-opacity: 0.8;

    /* BlockQuote Citation colors */
    --color-blockquote-citation-text: var(--color-text-secondary);
    --color-blockquote-citation-author: var(--color-text-primary);
    --color-blockquote-citation-source: var(--color-accent);
    --color-blockquote-citation-source-hover: var(--color-link-hover);
    --color-blockquote-citation-date: var(--color-text-secondary);

    /* Button colors */
    --color-button-primary-bg: var(--color-accent);
    --color-button-primary-text: var(--color-brand-white);
    --color-button-primary-hover-bg: var(--color-link-hover);
    --color-button-primary-hover-text: var(--color-brand-white);
    --color-button-secondary-bg: transparent;
    --color-button-secondary-text: var(--color-accent);
    --color-button-secondary-border: var(--color-accent);
    --color-button-secondary-hover-bg: var(--color-accent);
    --color-button-secondary-hover-text: var(--color-brand-white);
    --color-button-secondary-hover-border: var(--color-accent);

    /* -------------------- PAGE COLOURS -------------------- */
    /* Homepage specific colors */
    --color-homepage-link-border: var(--color-accent);
    --color-homepage-link-hover: var(--color-accent);

    /* Note list page colors */
    --color-notelist-title-hover: var(--color-accent);
    --color-notelist-date: var(--color-text-secondary);
    --color-notelist-border: var(--color-accent);

    /* Writing list page colors */
    --color-writinglist-title-hover: var(--color-accent);
    --color-writinglist-date: var(--color-text-secondary);
    --color-writinglist-border: var(--color-accent);
    --color-writinglist-platform-label: light-dark(var(--color-green-700), var(--color-green-500));
  }

  /* Dark theme typography overrides (light-dark() only works for colors) */
  @media (prefers-color-scheme: dark) {
    :root {
      --font-weight-prose: 350;
      --line-height-prose: 1.8;
      --font-weight-article: 250;
      --line-height-article: 1.6;
    }
  }

  /* Manual theme overrides */
  :root[data-theme='light'] {
    color-scheme: light;
    --font-weight-prose: 400;
    --line-height-prose: 1.7;
    --font-weight-article: 350;
    --line-height-article: 1.7;
  }

  :root[data-theme='dark'] {
    color-scheme: dark;
    --font-weight-prose: 350;
    --line-height-prose: 1.8;
    --font-weight-article: 250;
    --line-height-article: 1.6;
  }
}

/* Utility classes that need to be outside layers */
.cq {
  container-type: inline-size;
}

/* Hidden utility for screen readers and microformats */
.sr-only,
.hidden-microformat {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}
